// GET /BookmarkLecture.do?cmd=addBookmarkNew&bookmarkJson=%7B%22accmConnPage%22%3A%22%22%2C%22aprvUserNm%22%3A%22%22%2C%22aprvUserNo%22%3A%22%22%2C%22atchFilePath%22%3A%22%22%2C%22banCd%22%3A%22%22%2C%22classStudyCnt%22%3A0%2C%22connCnt%22%3A1%2C%22connPageCnt%22%3A0%2C%22connTm%22%3A7%2C%22connTotTm%22%3A7%2C%22critTm%22%3A0%2C%22crsCreCd%22%3A%22%22%2C%22errorCode%22%3A%220%22%2C%22finalConnPage%22%3A%22%22%2C%22firstStudyDttm%22%3A%22%22%2C%22gradeCd%22%3A%22%22%2C%22groupTm%22%3A0%2C%22gubun%22%3A%22%22%2C%22hisSn%22%3A0%2C%22lastConnUintCd%22%3A%22%22%2C%22listParam%22%3A%22%22%2C%22maxScore%22%3A0%2C%22message%22%3A%22%22%2C%22messageDetail%22%3A%22%22%2C%22minScore%22%3A0%2C%22mobileTm%22%3A0%2C%22modDttm%22%3A%2220170905114849%22%2C%22modNm%22%3A%22UnKnown%22%2C%22modNo%22%3A%22%22%2C%22parUnitCd%22%3A%22%22%2C%22passScore%22%3A0%2C%22pcTm%22%3A0%2C%22prgrChkType%22%3A%22%22%2C%22prgrChkYn%22%3A%22%22%2C%22prgrRatio%22%3A0.46666666666666673%2C%22quiz%22%3A%22%22%2C%22quizCnt%22%3A0%2C%22quizPassScore%22%3A0%2C%22quizPassYn%22%3A%22%22%2C%22quizUnitCd%22%3A%22%22%2C%22quizYn%22%3A%22%22%2C%22rNum%22%3A%22%22%2C%22regDttm%22%3A%2220170905114849%22%2C%22regId%22%3A%22%22%2C%22regNm%22%3A%22UnKnown%22%2C%22regNo%22%3A%22%22%2C%22result%22%3A%22true%22%2C%22sbjCd%22%3A%22NSC0000519%22%2C%22schlStudyDivCd%22%3A%22%22%2C%22schlStudyDivNm%22%3A%22%22%2C%22schlStudyDt%22%3A%22%22%2C%22schlStudyEndTm%22%3A%22%22%2C%22schlStudyStartTm%22%3A%22%22%2C%22searchDuration%22%3A%22%22%2C%22searchFrom%22%3A%22%22%2C%22searchKey%22%3A%22%22%2C%22searchTo%22%3A%22%22%2C%22searchValue%22%3A%22%22%2C%22sortKey%22%3A%22%22%2C%22stdCnt%22%3A0%2C%22stdNo%22%3A%22EN0000699197%22%2C%22studyDiv%22%3A%22PER%22%2C%22studyDivNm%22%3A%22%22%2C%22studyDttm%22%3A%2220170905114849%22%2C%22studyYn%22%3A%22%22%2C%22subCnt%22%3A0%2C%22subList%22%3A%5B%5D%2C%22summaryRatio%22%3A0%2C%22todayStudyYn%22%3A%22%22%2C%22totPageCnt%22%3A0%2C%22totalConnect%22%3A0%2C%22totalConnectTime%22%3A0%2C%22totalPage%22%3A0%2C%22unitCd%22%3A%22CNT000001349%22%2C%22unitFilePath%22%3A%22%22%2C%22unitLvl%22%3A0%2C%22unitNm%22%3A%22%22%2C%22unitOdr%22%3A0%2C%22unitPath%22%3A%22%22%2C%22unitType%22%3A%22%22%2C%22userId%22%3A%22%22%2C%22userNm%22%3A%22%22%2C%22userNo%22%3A%22%22%7D HTTP/1.1
// Host: youth.koreatech.ac.kr
// Content-Type: application/x-www-form-urlencoded
// Accept-Encoding: gzip, deflate
// Cookie: JSESSIONID=Ms0L786judVYpsXgHM1uM6Gpkacn2RHdwJEvVudUPa3oLVj2908z6GMLN5TlP27f.WAS2_servlet_engine3; __smVisitorID=PTmNWrNjSgx; _TRK_EX=24; _TRK_SID=b29f2ed5778e66687400438b62908e1f; _BS_GUUID=EPue78dXBQeRRcfuNPL9ey1ZT585mu11kwgrEtof; _TRK_UID=ea035a043cbbf862fe790bf902e0188e:1:0:1504577643434
// Connection: close
// Accept: application/json, text/javascript, */*
// User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_6) AppleWebKit/603.3.8 (KHTML, like Gecko) Version/10.1.2 Safari/603.3.8
// Referer: http://youth.koreatech.ac.kr/jsp/bookmark/study_edutrack_adapter.jsp
// Accept-Language: ko-kr
// X-Requested-With: XMLHttpRequest


// GET /Scorm.do?cmd=readCmiData&cmiCoreJson=%7B%22idref%22%3A%22%22%2C%22crsCreCd%22%3A%22O000732017322%22%2C%22sbjCd%22%3A%22NSC0000519%22%2C%22scoId%22%3A%22CNT000001349%22%2C%22learnerId%22%3A%22EN0000699197%22%2C%22learnerName%22%3A%22%EB%B0%95%EC%9E%AC%EC%84%B1%22%2C%22errorCode%22%3A%220%22%2C%22result%22%3A%22%22%2C%22sessionTime%22%3A%220%22%2C%22totalTime%22%3A%220%22%2C%22timeLimitAction%22%3A%22continue_no_message%22%2C%22maxTimeAllowed%22%3A%220%22%2C%22scaledPassingScore%22%3A0%2C%22cmiMode%22%3A%22browse%22%2C%22credit%22%3A%22no-credit%22%7D HTTP/1.1
// Host: youth.koreatech.ac.kr
// Content-Type: application/x-www-form-urlencoded
// Accept-Encoding: gzip, deflate
// Cookie: JSESSIONID=Ms0L786judVYpsXgHM1uM6Gpkacn2RHdwJEvVudUPa3oLVj2908z6GMLN5TlP27f.WAS2_servlet_engine3; __smVisitorID=PTmNWrNjSgx; _TRK_EX=4; _TRK_SID=6a2c5f76d080bb4f7fb310f2d33b30b9; _TRK_CR=http%3A%2F%2Fyouth.koreatech.ac.kr%2FMainYouth.do%3Fcmd=listCourseIng; _TRK_UID=ea035a043cbbf862fe790bf902e0188e:2:0.028910827546296296:1504582639225; _BS_GUUID=EPue78dXBQeRRcfuNPL9ey1ZT585mu11kwgrEtof
// Connection: close
// User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_6) AppleWebKit/603.3.8 (KHTML, like Gecko) Version/10.1.2 Safari/603.3.8
// Referer: http://youth.koreatech.ac.kr/jsp/bookmark/study_scorm_adapter.jsp
// Accept-Language: ko-kr
// X-Requested-With: XMLHttpRequest

const urlencode = require('urlencode');
const http = require('http');

const HOST = "youth.koreatech.ac.kr";
const PATH = "/BookmarkLecture.do?cmd=addBookmarkNew&bookmarkJson=";
const JSONData = { "accmConnPage": "", "aprvUserNm": "", "aprvUserNo": "", "atchFilePath": "", "banCd": "", "classStudyCnt": -999, "connCnt": -999, "connPageCnt": -999, "connTm": 1684, "connTotTm": 9, "critTm": 0, "crsCreCd": "", "errorCode": "0", "finalConnPage": "", "firstStudyDttm": "", "gradeCd": "", "groupTm": 0, "gubun": "", "hisSn": 0, "lastConnUintCd": "", "listParam": "", "maxScore": 0, "message": "", "messageDetail": "", "minScore": 0, "mobileTm": 0, "modDttm": "20170905114824", "modNm": "UnKnown", "modNo": "", "parUnitCd": "", "passScore": 0, "pcTm": 0, "prgrChkType": "", "prgrChkYn": "", "prgrRatio": 0.6, "quiz": "", "quizCnt": 0, "quizPassScore": 0, "quizPassYn": "", "quizUnitCd": "", "quizYn": "", "rNum": "", "regDttm": "20170905114824", "regId": "", "regNm": "UnKnown", "regNo": "", "result": "true", "sbjCd": "NSC0000519", "schlStudyDivCd": "", "schlStudyDivNm": "", "schlStudyDt": "", "schlStudyEndTm": "", "schlStudyStartTm": "", "searchDuration": "", "searchFrom": "", "searchKey": "", "searchTo": "", "searchValue": "", "sortKey": "", "stdCnt": 0, "stdNo": "EN0000699196", "studyDiv": "PER", "studyDivNm": "", "studyDttm": "20170905114824", "studyYn": "", "subCnt": 0, "subList": [], "summaryRatio": 0, "todayStudyYn": "", "totPageCnt": 0, "totalConnect": 0, "totalConnectTime": 0, "totalPage": 0, "unitCd": "CNT000001355", "unitFilePath": "", "unitLvl": 0, "unitNm": "", "unitOdr": 0, "unitPath": "", "unitType": "", "userId": "", "userNm": "", "userNo": "" };

const STDNO = ["CNT000001328", "CNT000001348", "CNT000001352"];

//init STDNO
const tmpStr = "CNT0000013"
const start = 52;

for (var i = 1; i <= 14; i++) {
    STDNO.push(tmpStr + (start + i));
}

console.log('STDNO : ', STDNO);

callback = function(response) {
    var str = '';

    //another chunk of data has been recieved, so append it to `str`
    response.on('data', function(chunk) {
        str += chunk;
    });

    //the whole response has been recieved, so we just print it out here
    response.on('end', function() {
        console.log(str);
    });
};



function getRandomTime() {
    //  return Math.floor((Math.random() * 420) + 1680);
    return 360;
}

function enocdeJSON(_json) {
    return urlencode(JSON.stringify(_json));
}
var options = {
    host: HOST,
    path: '',
    headers: {
        'Content-Type': 'application/x-www-form-urlencoded',
        'Accept-Encoding': 'gzip, deflate',
        'Accept-Language': 'ko-kr',
        'Cookie': 'BS_GUUID=LddzZixdjlaxxEaGZvdxZC9nuzBHyeSks5UrorFI; _TRK_UID=301f18fa8f17c1b28f46e50578a65395:1:0:1504585909071; _TRK_CR=http%3A%2F%2Fyouth.koreatech.ac.kr%2FMainYouth.do%3Fcmd=indexMain; _TRK_CQ=%3Fcmd=listCourseIng; __smVisitorID=RgpBBgH4Z4e; JSESSIONID=TajL13cE9uOGsBsslEcG1YdP5qfa1wstwMHcy0eZPEGpEgad92N9ifHfqUIouoaR.WAS2_servlet_engine3; _TRK_EX=11; _TRK_SID=8698f15b3b04ad08298269d00ef0c940'
    }
};

//send Request
for (var i = 0; i < STDNO.length; i++) {
    JSONData.connTm = getRandomTime();
    JSONData.unitCd = STDNO[i];
    const _PATH = PATH + enocdeJSON(JSONData);
    options.path = _PATH;
    console.log('Sending Request.... : ', i);
    console.log('Options : ', options);
    //send request
    http.request(options, callback).end();
}